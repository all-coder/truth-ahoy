--- Starting Data Reorganization ---
Reorganized data folder './deepfake_kaggle_reorganized' already exists. Skipping reorganization.
Delete the folder if you wish to re-process the data.

--- Starting Model Training with PyTorch and Timm ---
Using device: cuda
Classes found: ['fake', 'real']
/home/mms/dev/Google-GenAI-Exch-Hackathon/deepfake/efb.py:212: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = torch.cuda.amp.GradScaler(enabled=torch.cuda.is_available())

Epoch 1/50
----------
Train:   0%|                                                                                      | 0/3938 [00:00<?, ?it/s]/home/mms/dev/Google-GenAI-Exch-Hackathon/deepfake/efb.py:235: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=torch.cuda.is_available()):
Train: 100%|████████████████████████████████████████████████████| 3938/3938 [09:39<00:00,  6.79it/s, acc=0.938, loss=0.164]
Train Loss: 0.2798 Acc: 0.9046
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:20<00:00, 21.20it/s, acc=1, loss=0.0335]
Validation Loss: 0.0859 Acc: 0.9676

Epoch 2/50
----------
Train: 100%|███████████████████████████████████████████████████| 3938/3938 [09:21<00:00,  7.01it/s, acc=0.938, loss=0.0547]
Train Loss: 0.1237 Acc: 0.9497
Validation: 100%|█████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.10it/s, acc=0.944, loss=0.188]
Validation Loss: 0.0778 Acc: 0.9718

Epoch 3/50
----------
Train: 100%|████████████████████████████████████████████████████| 3938/3938 [09:21<00:00,  7.01it/s, acc=0.875, loss=0.134]
Train Loss: 0.1031 Acc: 0.9583
Validation: 100%|█████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.08it/s, acc=0.944, loss=0.137]
Validation Loss: 0.0465 Acc: 0.9829

Epoch 4/50
----------
Train: 100%|████████████████████████████████████████████████████| 3938/3938 [09:21<00:00,  7.01it/s, acc=0.875, loss=0.127]
Train Loss: 0.0933 Acc: 0.9615
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.03it/s, acc=1, loss=0.0305]
Validation Loss: 0.0657 Acc: 0.9764

Epoch 5/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.01it/s, acc=1, loss=0.0178]
Train Loss: 0.0829 Acc: 0.9660
Validation: 100%|██████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.04it/s, acc=1, loss=0.000183]
Validation Loss: 0.0520 Acc: 0.9829

Epoch 6/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0452]
Train Loss: 0.0805 Acc: 0.9663
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.96it/s, acc=1, loss=0.00682]
Validation Loss: 0.0450 Acc: 0.9841

Epoch 7/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0267]
Train Loss: 0.0755 Acc: 0.9686
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.96it/s, acc=1, loss=0.00437]
Validation Loss: 0.0386 Acc: 0.9864

Epoch 8/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0621]
Train Loss: 0.0729 Acc: 0.9692
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.01it/s, acc=1, loss=0.0113]
Validation Loss: 0.0453 Acc: 0.9851

Epoch 9/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.01it/s, acc=1, loss=0.0153]
Train Loss: 0.0721 Acc: 0.9695
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.96it/s, acc=1, loss=0.0237]
Validation Loss: 0.0369 Acc: 0.9868

Epoch 10/50
----------
Train: 100%|███████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=0.938, loss=0.0896]
Train Loss: 0.0679 Acc: 0.9714
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.01it/s, acc=1, loss=2.02e-5]
Validation Loss: 0.0408 Acc: 0.9864

Epoch 11/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0274]
Train Loss: 0.0662 Acc: 0.9723
Validation: 100%|█████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.11it/s, acc=0.944, loss=0.063]
Validation Loss: nan Acc: 0.9866

Epoch 12/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.01it/s, acc=1, loss=0.0396]
Train Loss: 0.0666 Acc: 0.9722
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.04it/s, acc=1, loss=0.0229]
Validation Loss: nan Acc: 0.9864

Epoch 13/50
----------
Train: 100%|████████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.018]
Train Loss: 0.0641 Acc: 0.9731
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 24.01it/s, acc=1, loss=0.0201]
Validation Loss: nan Acc: 0.9851

Epoch 14/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0648]
Train Loss: 0.0621 Acc: 0.9733
Validation: 100%|████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.94it/s, acc=0.944, loss=0.0593]
Validation Loss: 0.0986 Acc: 0.9714

Epoch 15/50
----------
Train: 100%|█████████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.01]
Train Loss: 0.0610 Acc: 0.9738
Validation: 100%|█████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.98it/s, acc=0.944, loss=0.253]
Validation Loss: 0.0498 Acc: 0.9838

Epoch 16/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0072]
Train Loss: 0.0610 Acc: 0.9741
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.99it/s, acc=1, loss=0.0108]
Validation Loss: 0.0474 Acc: 0.9882

Epoch 17/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0236]
Train Loss: 0.0600 Acc: 0.9745
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.88it/s, acc=1, loss=0.0151]
Validation Loss: nan Acc: 0.9875

Epoch 18/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0129]
Train Loss: 0.0594 Acc: 0.9747
Validation: 100%|█████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.90it/s, acc=0.944, loss=0.178]
Validation Loss: nan Acc: 0.9889

Epoch 19/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0428]
Train Loss: 0.0576 Acc: 0.9752
Validation: 100%|██████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.87it/s, acc=1, loss=0.000565]
Validation Loss: 0.0552 Acc: 0.9842

Epoch 20/50
----------
Train: 100%|███████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=0.938, loss=0.0539]
Train Loss: 0.0577 Acc: 0.9752
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.92it/s, acc=1, loss=0.00451]
Validation Loss: nan Acc: 0.9896

Epoch 21/50
----------
Train: 100%|█████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.000479]
Train Loss: 0.0564 Acc: 0.9760
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.91it/s, acc=1, loss=0.0243]
Validation Loss: nan Acc: 0.9881

Epoch 22/50
----------
Train: 100%|████████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.014]
Train Loss: 0.0557 Acc: 0.9763
Validation: 100%|██████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.88it/s, acc=1, loss=0.000147]
Validation Loss: nan Acc: 0.9864

Epoch 23/50
----------
Train: 100%|████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=0.938, loss=0.148]
Train Loss: 0.0543 Acc: 0.9773
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.85it/s, acc=1, loss=0.0202]
Validation Loss: nan Acc: 0.9841

Epoch 24/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  6.99it/s, acc=1, loss=0.00259]
Train Loss: 0.0551 Acc: 0.9762
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.87it/s, acc=1, loss=0.00219]
Validation Loss: nan Acc: 0.9886

Epoch 25/50
----------
Train: 100%|███████████████████████████████████████████████████| 3938/3938 [09:23<00:00,  6.99it/s, acc=0.938, loss=0.0892]
Train Loss: 0.0558 Acc: 0.9761
Validation: 100%|█████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.86it/s, acc=0.944, loss=0.148]
Validation Loss: nan Acc: 0.9834

Epoch 26/50
----------
Train: 100%|████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=0.938, loss=0.058]
Train Loss: 0.0532 Acc: 0.9774
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.93it/s, acc=1, loss=0.00158]
Validation Loss: nan Acc: 0.9876

Epoch 27/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0128]
Train Loss: 0.0525 Acc: 0.9780
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.82it/s, acc=1, loss=0.00667]
Validation Loss: nan Acc: 0.9864

Epoch 28/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.00118]
Train Loss: 0.0522 Acc: 0.9780
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.89it/s, acc=1, loss=0.00261]
Validation Loss: nan Acc: 0.9863

Epoch 29/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:25<00:00,  6.96it/s, acc=1, loss=0.00765]
Train Loss: 0.0521 Acc: 0.9779
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.45it/s, acc=1, loss=2.58e-5]
Validation Loss: nan Acc: 0.9846

Epoch 30/50
----------
Train: 100%|███████████████████████████████████████████████████| 3938/3938 [09:25<00:00,  6.97it/s, acc=0.938, loss=0.0778]
Train Loss: 0.0520 Acc: 0.9778
Validation: 100%|██████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.66it/s, acc=1, loss=0.000163]
Validation Loss: 0.0522 Acc: 0.9836

Epoch 31/50
----------
Train: 100%|█████████████████████████████████████████████████████| 3938/3938 [09:25<00:00,  6.97it/s, acc=1, loss=0.000186]
Train Loss: 0.0514 Acc: 0.9780
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.47it/s, acc=1, loss=0.00746]
Validation Loss: 0.0462 Acc: 0.9876

Epoch 32/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:25<00:00,  6.97it/s, acc=1, loss=0.00119]
Train Loss: 0.0501 Acc: 0.9789
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.59it/s, acc=1, loss=0.00608]
Validation Loss: 0.0429 Acc: 0.9878

Epoch 33/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:27<00:00,  6.94it/s, acc=1, loss=0.0116]
Train Loss: 0.0506 Acc: 0.9779
Validation: 100%|██████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.37it/s, acc=1, loss=0.000931]
Validation Loss: nan Acc: 0.9846

Epoch 34/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:24<00:00,  6.98it/s, acc=1, loss=0.00529]
Train Loss: 0.0493 Acc: 0.9790
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.92it/s, acc=1, loss=0.00446]
Validation Loss: nan Acc: 0.9854

Epoch 35/50
----------
Train: 100%|█████████████████████████████████████████████████████| 3938/3938 [09:24<00:00,  6.98it/s, acc=1, loss=0.000996]
Train Loss: 0.0493 Acc: 0.9788
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.92it/s, acc=1, loss=0.00045]
Validation Loss: nan Acc: 0.9855

Epoch 36/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:24<00:00,  6.98it/s, acc=1, loss=0.0194]
Train Loss: 0.0493 Acc: 0.9788
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.70it/s, acc=1, loss=0.00501]
Validation Loss: nan Acc: 0.9886

Epoch 37/50
----------
Train: 100%|████████████████████████████████████████████████████| 3938/3938 [09:24<00:00,  6.97it/s, acc=0.875, loss=0.379]
Train Loss: 0.0488 Acc: 0.9792
Validation: 100%|████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.20it/s, acc=0.944, loss=0.0688]
Validation Loss: 0.2193 Acc: 0.9864

Epoch 38/50
----------
Train: 100%|████████████████████████████████████████████████████████| 3938/3938 [09:23<00:00,  6.99it/s, acc=1, loss=0.033]
Train Loss: 0.0481 Acc: 0.9795
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.85it/s, acc=1, loss=0.00182]
Validation Loss: 0.0617 Acc: 0.9876

Epoch 39/50
----------
Train: 100%|███████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  6.99it/s, acc=0.938, loss=0.0762]
Train Loss: 0.0483 Acc: 0.9795
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.85it/s, acc=1, loss=2.12e-5]
Validation Loss: 0.0488 Acc: 0.9884

Epoch 40/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.00948]
Train Loss: 0.0473 Acc: 0.9795
Validation: 100%|██████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.77it/s, acc=1, loss=0.000243]
Validation Loss: 0.0507 Acc: 0.9876

Epoch 41/50
----------
Train: 100%|███████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=0.938, loss=0.0942]
Train Loss: 0.0463 Acc: 0.9807
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.83it/s, acc=1, loss=0.0109]
Validation Loss: 0.0481 Acc: 0.9869

Epoch 42/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.00699]
Train Loss: 0.0467 Acc: 0.9801
Validation: 100%|█████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.80it/s, acc=0.944, loss=0.563]
Validation Loss: 0.1127 Acc: 0.9834

Epoch 43/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:23<00:00,  6.99it/s, acc=1, loss=0.00235]
Train Loss: 0.0478 Acc: 0.9796
Validation: 100%|████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.85it/s, acc=0.944, loss=0.0516]
Validation Loss: 0.0617 Acc: 0.9851

Epoch 44/50
----------
Train: 100%|██████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.00359]
Train Loss: 0.0482 Acc: 0.9790
Validation: 100%|████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.84it/s, acc=0.944, loss=0.0767]
Validation Loss: 0.0455 Acc: 0.9875

Epoch 45/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0132]
Train Loss: 0.0460 Acc: 0.9804
Validation: 100%|██████████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.86it/s, acc=1, loss=5e-5]
Validation Loss: nan Acc: 0.9871

Epoch 46/50
----------
Train: 100%|███████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=0.938, loss=0.0548]
Train Loss: 0.0455 Acc: 0.9807
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.84it/s, acc=1, loss=0.00121]
Validation Loss: nan Acc: 0.9851

Epoch 47/50
----------
Train: 100%|█████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.000239]
Train Loss: 0.0455 Acc: 0.9808
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.89it/s, acc=1, loss=0.00224]
Validation Loss: nan Acc: 0.9866

Epoch 48/50
----------
Train: 100%|███████████████████████████████████████████████████████| 3938/3938 [09:22<00:00,  7.00it/s, acc=1, loss=0.0292]
Train Loss: 0.0443 Acc: 0.9810
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.62it/s, acc=1, loss=0.00886]
Validation Loss: nan Acc: 0.9889

Epoch 49/50
----------
Train: 100%|████████████████████████████████████████████████████| 3938/3938 [09:25<00:00,  6.96it/s, acc=0.875, loss=0.174]
Train Loss: 0.0453 Acc: 0.9806
Validation: 100%|████████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.43it/s, acc=1, loss=0.0174]
Validation Loss: nan Acc: 0.9864

Epoch 50/50
----------
Train: 100%|█████████████████████████████████████████████████████| 3938/3938 [09:25<00:00,  6.97it/s, acc=1, loss=0.000321]
Train Loss: 0.0435 Acc: 0.9814
Validation: 100%|███████████████████████████████████████████████████| 438/438 [00:18<00:00, 23.67it/s, acc=1, loss=5.23e-7]
Validation Loss: nan Acc: 0.9869

Training complete.
Model saved to ./efficientnet-b1-timm-deepfake-detector

--- Starting Post-Training Evaluation and Visualization ---
Evaluating: 100%|████████████████████████████████████████████████████████████████████████| 438/438 [00:31<00:00, 14.07it/s]
Generating Precision-Recall curve...
Precision-Recall curve saved to ./efficientnet-b1-timm-deepfake-detector/precision_recall_curve.png